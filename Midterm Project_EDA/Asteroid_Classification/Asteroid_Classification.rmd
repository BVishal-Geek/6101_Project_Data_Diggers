---
title: "Evaluating Asteroid Characteristics and Predicting Hazard Levels Using NASA's Asteroid Classification Dataset"
author: "Vishal Bakshi, Pratiksha Dange, Sudanshu Dotel, Qibin Huang"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
    number_sections: false
    toc: yes
    toc_depth: 3
    toc_float: yes
---


```{r init, include=FALSE}
# some of common options (and the defaults) are: 
# include=T, eval=T, echo=T, results='hide'/'asis'/'markup',..., collapse=F, warning=T, message=T, error=T, cache=T, fig.width=6, fig.height=4, fig.dim=c(6,4) #inches, fig.align='left'/'center','right', 
library(ezids)
# knitr::opts_chunk$set(warning = F, results = "markup", message = F)
knitr::opts_chunk$set(warning = F, results = "hide", message = F)
options(scientific=T, digits = 3) 
library(dplyr)
library(kableExtra)
library(ggplot2)
library()

# options(scipen=9, digits = 3)  
# ‘scipen’: integer. A penalty to be applied when deciding to print numeric values in fixed or exponential notation.  Positive values bias towards fixed and negative towards scientific notation: fixed notation will be preferred unless it is more than ‘scipen’ digits wider.
# use scipen=999 to prevent scientific notation at all times
```

```{css, include=FALSE}
.columns {display: flex;}
h1 {color: #87CEFA}
h2 {color:blue}
```

<div class="column-definitions">
  <p><strong>1. Neo Reference ID:</strong> ID for the Asteroid</p>
  <p><strong>2. Name:</strong> Name of the Asteroid</p>
  <p><strong>3. Absolute Magnitude:</strong> Indicates the brightness of the asteroid; lower magnitude means a brighter star, higher magnitude means a dimmer star.</p>
  <p><strong>4. Est Dia in KM (min):</strong> Estimated minimum size of the asteroid in kilometers.</p>
  <p><strong>5. Est Dia in KM (max):</strong> Estimated maximum size of the asteroid in kilometers.</p>
  <p><strong>6. Relative Velocity (km per sec):</strong> The velocity of the asteroid.</p>
  <p><strong>7. Orbit Uncertainty Minimum:</strong> A measure of the uncertainty in the asteroid's orbit.</p>
  <p><strong>8. Jupiter Tisserand Invariant:</strong> The JTI measures the influence of Jupiter's gravitational pull on celestial bodies; lower JTI values are farther from Jupiter.</p>
  <p><strong>9. Eccentricity:</strong> Determines the shape of the orbit; 0 < E < 1 indicates an ellipse, E = 1 is a parabola, and E > 1 is a hyperbola.</p>
  <p><strong>10. Semi Major Axis:</strong> Indicates the size of the asteroid's orbit.</p>
  <p><strong>11. Inclination:</strong> Denotes the tilt of the asteroid's orbit.</p>
  <p><strong>12. Perihelion Distance:</strong> Indicates how close the asteroid gets to the Sun during its orbit.</p>
  <p><strong>13. Aphelion Dist:</strong> Specifies how far the asteroid is from the Sun during its orbit.</p>
  <p><strong>14. Perihelion Time:</strong> The time when the asteroid is closest to the Sun.</p>
  <p><strong>15. Mean Motion:</strong> Provides information about how the asteroid moves in its orbit.</p>
  <p><strong>16. Hazardous:</strong> Target variable indicating whether the asteroid is considered hazardous to Earth; 1 for hazardous, 0 for not hazardous.</p>
</div>

<style>
  .column-definitions {
    font-family: Arial, sans-serif;
    padding: 10px;
    border: 1px solid #ccc;
    background-color: #f7f7f7;
  }
</style>



## Importing Dataset & Checking Summary Statistics

```{r, include=TRUE, echo=TRUE, results='show'}
current_directory <- getwd()
data_path <- "Datasets/Asteroid_Hazard_Classification.csv"
file_path <- file.path(dirname(current_directory), data_path)
Ast_raw <- data.frame(read.csv(file_path))

kable(summary(Ast_raw), "html") %>%
  kable_paper(full_width = FALSE) %>% 
  scroll_box(width = "100%", height = "400px")
```



## Data Preprocessing

### Step : 1 : Converting the Hazard column from string to integer, and into categorical.

```{r, include=TRUE, echo=TRUE, results='show'}
Ast_raw <- Ast_raw %>%
mutate(Hazardous = as.integer(Hazardous))#(1 is True, 0 is False)
Ast_raw$Hazardous <- as.factor(Ast_raw$Hazardous)
kable(Ast_raw, "html") %>%
  kable_paper(full_width = FALSE) %>% 
  scroll_box(width = "100%", height = "400px")
```


### Step : 2 : Dropping columns which are not required for our analysis:

```{r, include=TRUE, echo=TRUE, results='asis'}
# Load required libraries
library(knitr)
library(kableExtra)

selected_columns <- c('Neo.Reference.ID', 'Name', 'Absolute.Magnitude', 'Est.Dia.in.KM.min.', 'Est.Dia.in.KM.max.', 'Relative.Velocity.km.per.sec', 'Orbit.Uncertainity', 'Jupiter.Tisserand.Invariant', 'Eccentricity', 'Semi.Major.Axis', 'Inclination', 'Perihelion.Distance', 'Aphelion.Dist', 'Mean.Motion', 'Hazardous')

Ast_Subset <- subset(Ast_raw, select = selected_columns)

# Create a nicely formatted table
kable(Ast_Subset, "html") %>%
  kable_paper(full_width = FALSE) %>% 
  scroll_box(width = "100%", height = "400px")

```

The reason to drop the columns is to easily carry out the inferences and also according to the domain knowledge we acquired, the columns which we dropped are not very useful for our analysis. 

### Step : 3 : Outlier Check: 

```{r}
find_outliers <- function(x) {
  q1 <- quantile(x, 0.25)
  q3 <- quantile(x, 0.75)
  iqr <- q3 - q1
  lower_bound <- q1 - 1.5 * iqr
  upper_bound <- q3 + 1.5 * iqr
  return(x[x < lower_bound | x > upper_bound])
}

# Find and remove outliers in the minimum diameter
outliers_min <- find_outliers(Ast_Subset$Est.Dia.in.KM.min.)
data_cleaned_min <- Ast_Subset[!(Ast_Subset$Est.Dia.in.KM.min. %in% outliers_min), ]

# Find and remove outliers in the maximum diameter
outliers_max <- find_outliers(Ast_Subset$Est.Dia.in.KM.max.)
data_cleaned_max <- Ast_Subset[!(Ast_Subset$Est.Dia.in.KM.max. %in% outliers_max), ]

par(mfrow=c(2,2))

hist(Ast_Subset$Est.Dia.in.KM.min., main="Minimum Diameter", xlab="Est Dia in KM (min)", col="blue")
hist(data_cleaned_min$Est.Dia.in.KM.min., main="Minimum Diameter (Cleaned)", xlab="Est Dia in KM (min)", col="blue")

hist(Ast_Subset$Est.Dia.in.KM.max., main="Maximum Diameter", xlab="Est Dia in KM (max)", col="blue")
hist(data_cleaned_max$Est.Dia.in.KM.max., main="Maximum Diameter (Cleaned)", xlab="Est Dia in KM (max)", col="blue")


# Q-Q plot for minimum asteroid diameter
#original data
qqnorm(Ast_Subset$Est.Dia.in.KM.min.)
qqline(Ast_Subset$Est.Dia.in.KM.min.)
#clean data
qqnorm(data_cleaned_min$Est.Dia.in.KM.min.)
qqline(data_cleaned_min$Est.Dia.in.KM.min.)


# Q-Q plot for maximum asteroid diameter

#original data
qqnorm(Ast_Subset$Est.Dia.in.KM.max.)
qqline(Ast_Subset$Est.Dia.in.KM.max.)
#clean data
qqnorm(data_cleaned_max$Est.Dia.in.KM.max.)
qqline(data_cleaned_max$Est.Dia.in.KM.max.)


shapiro.test(data_cleaned_min$Est.Dia.in.KM.min.)
shapiro.test(data_cleaned_max$Est.Dia.in.KM.max.)



```
We performed outlier check on diameter of the asteroid, in which we got to know that p-values for both the minimum and maximum asteroid diameters are less than 2e-16, indicating that the data significantly deviates from a normal distribution.
However, removing outliers was not common in our case. As the data was asymmetrical with 30% hazardous and 70% non-hazardous. It is very likely that our data wouldn't pass 3000 minimum rows rule and also it might be the case where majority of hazardous rows will be eliminated too.  

### Step : 4 : Checking for Normal Distribution using QQ-Plot

```{r, include=TRUE, echo=TRUE, results='asis'}

# Load the ggplot2 package
library(ggplot2)

kable(summary(Ast_Subset), "html") %>%
  kable_paper(full_width = FALSE) %>% 
  scroll_box(width = "100%", height = "400px")

# Create a Q-Q plot
qqnorm(Ast_Subset$Perihelion.Distance, main = "Q-Q Plot of Perihelion Distance")

# Add a Q-Q line (e.g., line for the normal distribution)
qqline(Ast_Subset$Perihelion.Distance, distribution = qnorm)


# Create a Q-Q plot
qqnorm(Ast_Subset$Aphelion.Dist, main = "Q-Q Plot of Aphelion Distance")

# Add a Q-Q line (e.g., line for the normal distribution )
qqline(Ast_Subset$Aphelion.Dist, distribution = qnorm)
```

According to the QQ-Plot and QQ-Line, its clear that we have some skewness and outliers. Reason to not drop outliers is, it is very likely that our data wouldn't pass 3000 minimum rows rule and also it might be the case where majority of hazardous rows will be eliminated too. 

## Data Visualization  

## Histogram plots to check the distribution

### Part 1: Checking Histograms for Distributions

#### Part 1.1 : Absolute Magnitude, Estimated Diameter (Min), Estimated Diameter (Max) 

```{r}
library(ggplot2)
# Load the tidyr package
library(tidyr)

# Create a histogram for 'Absolute.Magnitude', 'Est.Dia.in.KM.min.', and 'Est.Dia.in.KM.max'
selected_columns_1 <- Ast_Subset[c('Absolute.Magnitude', 'Est.Dia.in.KM.min.', 'Est.Dia.in.KM.max.')]

# Reshape the data into long format
Ast_Subset_long_1 <- pivot_longer(selected_columns_1, 
                                cols = everything(),
                                names_to = "Variable", values_to = "Value")

# Create the histogram
ggplot(Ast_Subset_long_1, aes(x = Value, fill = Variable, color = "black")) +
  geom_histogram(binwidth = 1.0, alpha = 0.7, position = "identity", show.legend = FALSE) +
  facet_wrap(~Variable, scales = "free") +
  labs(title = "Histogram of Absolute Magnitude, Est.Dia.in.KM.min., Est.Dia.in.KM.max", x = "Value", y = "Frequency") +
  scale_fill_manual(values = rainbow(length(unique(Ast_Subset_long_1$Variable))) ) +
  scale_color_manual(values = "black") +
  theme_minimal() +
  theme(legend.position = "right")


```

### Part 1.2 : Histograms for Velocity, Orbit Uncertainity, Jupiter Tisserand Invariant

```{r, include=TRUE, echo=TRUE, results='asis'}


# Create a histogram for 'Relative.Velocity.km.per.sec', 'Orbit.Uncertainity', and 'Jupiter.Tisserand.Invariant'
selected_columns_2 <- Ast_Subset[c('Relative.Velocity.km.per.sec', 'Orbit.Uncertainity', 'Jupiter.Tisserand.Invariant')]

# Reshape the data into long format
Ast_Subset_long_2 <- pivot_longer(selected_columns_2, 
                                cols = everything(),
                                names_to = "Variable", values_to = "Value")

# Create the histogram
ggplot(Ast_Subset_long_2, aes(x = Value, fill = Variable, color = "black")) +
  geom_histogram(binwidth = 1.0, alpha = 0.7, position = "identity", show.legend = FALSE) +
  facet_wrap(~Variable, scales = "free") +
  labs(title = "Histogram of Relative.Velocity.km.per.sec, Orbit.Uncertainity, Jupiter.Tisserand.Invariant", x = "Value", y = "Frequency") +
  scale_fill_manual(values = rainbow(length(unique(Ast_Subset_long_2$Variable))) ) +
  scale_color_manual(values = "black") +
  theme_minimal() +
  theme(legend.position = "right")


```

### Part 1.3 : Histograms for Eccentricity, Semi Major Axis, inclination. 

```{r, include=TRUE, echo=TRUE, results='asis'}

# Create a histogram for 'Eccentricity', 'Semi.Major.Axis', and 'Inclination'
selected_columns_3 <- Ast_Subset[c('Eccentricity', 'Semi.Major.Axis', 'Inclination')]

# Reshape the data into long format
Ast_Subset_long_3 <- pivot_longer(selected_columns_3, 
                                cols = everything(),
                                names_to = "Variable", values_to = "Value")

# Create the histogram
ggplot(Ast_Subset_long_3, aes(x = Value, fill = Variable, color = "black")) +
  geom_histogram(binwidth = 0.1, alpha = 0.7, position = "identity", show.legend = FALSE) +
  facet_wrap(~Variable, scales = "free") +
  labs(title = "Histogram of Eccentricity, Semi.Major.Axis, Inclination", x = "Value", y = "Frequency") +
  scale_fill_manual(values = rainbow(length(unique(Ast_Subset_long_3$Variable))) ) +
  scale_color_manual(values = "black") +
  theme_minimal() +
  theme(legend.position = "right")



```

### Part 1.4 : Histogram for Perihelion Distance, Aphelion Distance, Mean Motion 

```{r, include=TRUE, echo=TRUE, results='asis'}
# Create a histogram for 'Perihelion.Distance', 'Aphelion.Dist', 'Mean.Motion'
selected_columns_4 <- Ast_Subset[c('Perihelion.Distance', 'Aphelion.Dist', 'Mean.Motion')]

# Reshape the data into long format
Ast_Subset_long_4 <- pivot_longer(selected_columns_4, 
                                cols = everything(),
                                names_to = "Variable", values_to = "Value")

# Create the histogram
ggplot(Ast_Subset_long_4, aes(x = Value, fill = Variable, color = "black")) +
  geom_histogram(binwidth = 0.1, alpha = 0.7, position = "identity", show.legend = FALSE) +
  facet_wrap(~Variable, scales = "free") +
  labs(title = "Histogram of Perihelion.Distance, Aphelion.Dist, Perihelion.Time, Mean.Motion", x = "Value", y = "Frequency") +
  scale_fill_manual(values = rainbow(length(unique(Ast_Subset_long_4$Variable))) ) +
  scale_color_manual(values = "black") +
  theme_minimal() +
  theme(legend.position = "right")
```

Above provided histograms are the most important variables for this analysis. We can visually state that Absolute Magintude, Jupiter Invariant, Eccentricity are normally distributed and every other graph is either left or right skewed. Orbit Uncertainity is bi-model. 

### Part : 1.5 : Checking if the target variable is symmetrical/ Asymmetrical. 
```{r, include=TRUE, echo=TRUE, results='asis'}

# Create a pie chart for a binary categorical variable
counts <- table(Ast_Subset$Hazardous)

# Assign labels to the counts
labels <- c("Not Hazardous", "Hazardous")

# Create the pie chart
pie(counts, labels = labels, main = "Distribution of Asteroids by Hazardous & Non-Hazardous Status")

```

When going to the distributions of the hazardous column. It is clearly visible that the Non-Hazardous Asteroids are more compared to Hazardous.
The data is Asymmetrical. 
Considering the 3000 minimum rows rule, leveling/making data symmetrical is not a viable option right now. 


## Understanding Patterns With Respect To Domain Knowledge

### Part: 1: JTI vs Eccentricity

```{r, include=TRUE, echo=TRUE, results='asis'}
# Load the ggplot2 package
library(ggplot2)


# Create a scatter plot with color based on a categorical variable
ggplot(Ast_Subset, aes(x = Jupiter.Tisserand.Invariant, y = Eccentricity, color = Hazardous)) +
  geom_point() +
  labs(title = "Scatter Plot of JTI vs Eccentricity with respect to Hazardous", x = "JTI", y = "Eccentricity") +
  scale_color_discrete(name = "JTI vs Eccentricity") 

```

Domain Knowledge: JTI a.k.a Jupiter Tisserand Invariant is the value which represents the gravitational pull of a celestial body. It might be one of the reasons of the change in the eccentricity of an asteroid. 
We can clearly see that the increase in the level of the Jupiter Tisserand Invariant in the plot is making Eccentricity decrease. Greater gravitional pull from the jupiter can lead to change in asteroid eccentricity from ellipse to circle. 


### Part 2 : Perihelion vs Eccentricity With Respect To Hazardous

```{r, include=TRUE, echo=TRUE, results='asis'}
library(plotly)


# Create a 3D scatter plot
plot <- ggplot(Ast_Subset, aes(x = Eccentricity, y = Perihelion.Distance, z = Hazardous, color = Hazardous)) +
  geom_point() +
  labs(title = "3D Scatter Plot of Perihelion Distance vs Eccentricity with respect to Hazardous", x = "Eccentricity", y = "Perihelion Distance", z = "Hazardous") +
  scale_color_discrete(name = "Perihelion Distance vs Eccentricity")

# Convert the ggplot plot to a 3D plotly plot
plotly_plot <- ggplotly(plot)

# Show the interactive 3D plot
plotly_plot

```
According to the domain knowledge/math E(Eccentricity) > 0 forms an elliptical shape. 
As the data is Asymmetrical with 70% (Non-Hazardous) and 30% (Hazardous). We can see more scatter points of Non-Hazardous. 
Whereas, considering the Hazardous Asteroids, Increase in Eccentricity is directly proportional to the change in perihelion distance. 
Perihelion Distance (Closest point to the Sun): When the Perihelion Distance is less, it directly enters into the Hazardous category. 

To prove the above given statement: 

```{r}

ggplot(Ast_Subset, aes(x = as.factor(Hazardous), y = `Perihelion.Distance`)) +
  geom_boxplot(fill= "skyblue") +
  labs(title = "Perihelion Distance vs Hazardous", x = "Hazardous", y = "Perihelion Distance")

ggplot(Ast_Subset, aes(x = as.factor(Hazardous), y = `Aphelion.Dist`)) +
  geom_boxplot(fill= "skyblue") +
  labs(title = "Aphelion Distance vs Hazardous", x = "Hazardous", y = "Aphelion Distance")

```

By observing the box plots, it is clear that higher perihelion distance has less effect of being hazard to earth, where as the less perihelion distance are more hazardous in nature. 

To Statistically Prove it using Smart Question 1: 

### SMART Question : 1 : How do the hazard classifications of asteroids relate to their proximity to Earth in terms of Perihelion and Aphelion distances?

** Null Hypothesis **: There is no significant difference in perihelion distance for hazardous and non-hazardous asteroids.
** Alternate Hypothesis **: There is significant difference in perihelion distance for hazardous and non-hazardous asteroids. 

```{r, include=TRUE, echo=TRUE, results='asis'}
t_test_perihelion <- t.test(`Perihelion.Distance` ~ Hazardous, data = Ast_Subset)
t_test_aphelion <- t.test(`Aphelion.Dist` ~ Hazardous, data = Ast_Subset)

```

```{r, include=TRUE, echo=TRUE, results='asis'}
# Show the results

print(t_test_perihelion)
```

```{r, include=TRUE, echo=TRUE, results='asis'}
# Show the results
print(t_test_aphelion)
```
Observation: 

Perihelion Distance: P-Value < Alpha Value. So, we reject null hypothesis. 
There is an observable trend where hazardous asteroids tend to exhibit smaller perihelion distances when compared to their non-hazardous counterparts.

Aphelion Distance: A subtle yet statistically significant variation emerges, with asteroids possessing higher aphelion distances demonstrating a slightly increased likelihood of being classified as hazardous. Nevertheless, it's important to note that the means of the two groups remain closely aligned. Thus, we cannot definitively attribute higher aphelion distance as the sole determinant of an asteroid's hazardous classification.


### Part : 3 : Aphelion Distance vs Eccentricity With Respect To Hazardous

```{r, include=TRUE, echo=TRUE, results='asis'}
# Create a 3D scatter plot
plot <- ggplot(Ast_Subset, aes(x = Eccentricity, y = Aphelion.Dist, z = Hazardous, color = Hazardous)) +
  geom_point() +
  labs(title = "3D Scatter Plot of Aphelion Distance vs Eccentricity with respect to Hazardous", x = "Eccentricity", y = "Aphelion Distance", z = "Hazardous") +
  scale_color_discrete(name = "Aphelion Distance vs Eccentricity")

# Convert the ggplot plot to a 3D plotly plot
plotly_plot <- ggplotly(plot)

# Show the interactive 3D plot
plotly_plot

```

Eccentricity is directly proportional to the aphelion distance. Less the Eccentricity, more the circular orbit and less the Aphelion Distance. 
According to the plot, majority of the plots are overlapped, so Aphelion distance alone is not effecting the asteroid to be Hazardous. 


```{r, include=TRUE, echo=TRUE, results='asis'}
library(ggplot2)
library(tidyr)


# List of variables for density plots
variables <- c('Absolute.Magnitude', 
               'Relative.Velocity.km.per.sec', 'Jupiter.Tisserand.Invariant', 
               'Inclination', 'Mean.Motion')

# Create density plots for each variable
for (variable in variables) {
  p <- ggplot(Ast_Subset, aes_string(x = variable, fill = 'Hazardous')) +
    geom_density(alpha = 0.5) +
    labs(title = paste('Density Plot of', variable),
         x = variable,
         y = 'Density') +
    theme_minimal()
   
  print(p)
}
```

**Absolute Magnitude Observation:** Hazardous asteroids tend to have a lower absolute magnitude. Explanation: Absolute magnitude is a measure of an asteroid’s brightness. A lower absolute magnitude indicates a brighter object. Since hazardous asteroids are often closer to Earth, they may appear brighter, resulting in a lower absolute magnitude.

**Relative Velocity km per sec Observation:** Hazardous asteroids have a wider range of relative velocities. Explanation: This suggests that hazardous asteroids can be traveling at a variety of speeds relative to Earth. Higher speeds could increase the potential hazard of an asteroid.

**Jupiter Tisserand Invariant Observation:** The distribution seems quite similar for both hazardous and non-hazardous asteroids. Explanation: The Jupiter Tisserand Invariant is used to differentiate between asteroids and Jupiter-family comets. The similar distribution suggests that this variable alone might not be a strong predictor of an asteroid’s hazardous classification.

**Inclination Observation:** Hazardous asteroids have a wider range of inclinations. Explanation: Inclination is the tilt of an asteroid’s orbit plane. A wider range of inclinations for hazardous asteroids indicates that they can come from various directions relative to Earth’s orbital plane.

**Mean Motion Observation:** The distribution seems quite similar for both hazardous and non-hazardous asteroids. Explanation: Mean motion is the average motion of the asteroid. The similar distribution indicates that mean motion might not be a significant factor in determining whether an asteroid is hazardous.


## SMART QUESTIONS 

### Question : 2 : Does the impact of Perihelion Distance varying with the absolute magnitude.

```{r, include=TRUE, echo=TRUE, results='asis'}

ggplot(Ast_Subset, aes(x = `Perihelion.Distance`, y = `Absolute.Magnitude`, color = Hazardous)) +
  geom_point(alpha = 0.6) +
  labs(title = "Perihelion Distance vs. Absolute Magnitude", x = "Perihelion Distance", y = "Absolute Magnitude") +
  theme_minimal()

```

Perihelion Distance vs. Absolute Magnitude Description: This plot illustrates how the brightness of an asteroid (in terms of absolute magnitude) relates to its perihelion distance, which is the closest point in its orbit to the Sun. Potential Insight: Hazardous asteroids might tend to have smaller perihelion distances, indicating they come closer to the Sun (and potentially Earth’s orbit). Brighter asteroids (with lower absolute magnitude) might be more easily detected, and their orbits more precisely determined, leading to a higher likelihood of being classified as hazardous if they come close to Earth.


### Question : 3 : Is there any significant difference in the orbit uncertainty, Mean Motion, and inclination with a change in Perihelion Distance? <br> - Reason: Here we are examining the relationship between orbit uncertainty, mean motion, and inclination and perihelion distance (also a numeric variable). <br>

```{r , include=TRUE, echo=TRUE, results='show'}

# Perform ANOVA for 'OrbitUncertainty' with 'PerihelionDistance'

Ast_Subset$Orbit.Uncertainity <- as.factor(Ast_Subset$Orbit.Uncertainity)
orbitU_perihelionDist_anova <- aov(`Orbit.Uncertainity` ~ `Perihelion.Distance`, data = Ast_raw)
summary(orbitU_perihelionDist_anova)

```

```{r, include=TRUE, echo=TRUE, results='asis'}

# Perform Two Sampled T-Test for 'MeanMotion' with 'PerihelionDistance'
meanM_perihelionDist_Ttest <- t.test(Ast_Subset$Mean.Motion, Ast_Subset$Perihelion.Distance)
meanM_perihelionDist_Ttest

```

```{r, include=TRUE, echo=TRUE, results='asis'}

# Perform Two Sampled T-Test for 'Inclination' with 'PerihelionDistance'
inclination_perihelionDist_anova <- t.test(Ast_Subset$Inclination, Ast_Subset$Perihelion.Distance)
inclination_perihelionDist_anova

```

**Test 1 - Orbit Uncertainty vs. Perihelion Distance:**

-   Df (Degrees of Freedom): There is 1 degree of freedom associated with Perihelion Distance, and 3690 degrees of freedom for residuals.
-   Sum Sq (Sum of Squares): The sum of squares for Perihelion Distance is 381, and for residuals, it's 35756.
-   Mean Sq (Mean Square): The mean square for Perihelion Distance is 381.
-   F value: The F-statistic is 39.4.
-   Pr(\>F): The p-value is approximately 3.9e-10, which is extremely small.

**Interpretation:** In this test, the p-value (Pr(\>F)) is very small (3.9e-10), which indicates that there is a statistically significant difference in "Orbit Uncertainty" with a change in "Perihelion Distance." This suggests that "Perihelion Distance" has a significant impact on "Orbit Uncertainty."

**Test 2 - Mean Motion vs. Perihelion Distance:**
The very low p-value (<2e-16) strongly rejects the null hypothesis, indicating a significant difference between "Mean.Motion" and "Perihelion.Distance." The negative t-statistic (-22) suggests "Mean.Motion" is notably lower than "Perihelion.Distance." Additionally, the 95% confidence interval excludes 0, further supporting this conclusion. In practical terms, this signifies a statistically significant difference, and you should explore its implications for your research or context.

**Test 3 - Inclination vs. Perihelion Distance:**
The very low p-value (<2e-16) strongly rejects the null hypothesis, indicating a significant difference between "Inclination" and "Perihelion.Distance." With a positive t-statistic (69), "Inclination" significantly exceeds "Perihelion.Distance." The 95% confidence interval supports this finding, as it excludes 0.

In summary, based on these ANOVA tests, it appears that "Perihelion Distance" has a significant impact on "Orbit Uncertainty," "Mean Motion," and "Inclination," with "Mean Motion" having the most substantial effect, followed by "Orbit Uncertainty" and then "Inclination." The p-values for all three tests suggest that the relationships are statistically significant.

### Question : 4 : Can we measure the impact of eccentricity on asteroid hazard classification using statistical tests?

```{r, include=TRUE, echo=TRUE, results='asis'}

ggplot(Ast_Subset, aes(x = as.factor(Hazardous), y = Eccentricity)) +
  geom_boxplot(fill= "skyblue") +
  labs(title = "Eccentricity vs Hazardous", x = "Hazardous", y = "Eccentricity")

```

The box plots provide a visual representation of the distribution of Eccentricity for both hazardous and non-hazardous asteroids.

Observations: Eccentricity: The distribution of eccentricity appears to be quite similar for both hazardous and non-hazardous asteroids. However, there are some outliers in each category.

To confirm these observations and determine if the differences are statistically significant, we will perform ANOVA tests on both Eccentricity and Perihelion Distance for hazardous and non-hazardous asteroids.

```{r, include=TRUE, echo=TRUE, results='asis'}

anova_eccentricity <- aov(Eccentricity ~ Hazardous, data = Ast_Subset)
summary(anova_eccentricity)

```
Interpretation: Eccentricity: Since the PValue (5.88* 10^-30) is significantly less than our alpha level of 0.05, we reject the null hypothesis. This indicates that there is a significant impact of eccentricity on asteroid hazard classification.



### Question : 5 : What are the most influential features in predicting whether an asteroid is hazardous ? 
```{r, include=TRUE, echo=TRUE, results='asis', fig.width=10, fig.height=10}

library(corrplot)

# List of specified variables for the correlation plot
specified_variables <- c('Absolute.Magnitude', 'Est.Dia.in.KM.min.', 'Est.Dia.in.KM.max.', 
                         'Relative.Velocity.km.per.sec', 'Minimum.Orbit.Intersection', 
                         'Jupiter.Tisserand.Invariant', 'Eccentricity', 
                         'Semi.Major.Axis', 'Inclination', 'Perihelion.Distance', 
                          'Aphelion.Dist', 'Mean.Motion')

# Calculate the correlation matrix for the specified variables
correlation_matrix_specified <- cor(Ast_raw[, specified_variables], use = "complete.obs")

# Create a correlation plot
corrplot(correlation_matrix_specified, method = "color", tl.cex = 0.7, number.cex = 0.7, addCoef.col = "black")
```

Now to identify the most influential features the impacted the target column, we had two main choices. One, finding out which predictor variables have a high correlation with the target variable and next training a classification model and assess the feature importance scores generated by the model to identify the most influential features for predicting the asteroid hazard.

We had to discard the first, correlation approach, because the target variable "Hazardous" is a binary categorical variable, and the correlation between binary variables and continuous variables isn't that meaningful.

So, we went ahead with the latter approach. we decided to train a random forest model and get the feature importance scores generated by the model to find out the most influential features. 

We decided to use a Random Forest model to determine feature importance in our case for the following reasons:

1. **Non-linearity Handling:** Random Forest is effective at capturing complex, non-linear relationships in the data. In the context of asteroid hazard prediction, the relationship between various features and the target variable ("Hazardous") is non-linear.

2. **Feature Importance:** Random Forest provides a straightforward way to calculate feature importance. It measures the contribution of each predictor variable in reducing impurity or increasing the Gini index.

3. **Outlier Robustness:** Random Forest is robust to outliers and noisy data, which can be important when working with astronomical datasets like this one.

4. **Variable Types:** Random Forest can handle a mix of categorical and numeric predictor variables.

```{r, include=TRUE, echo=TRUE, results='show'}

# Install the following package (if not already)
# install.packages("randomForest")

library(randomForest)

# Splitting the dataset into predictors (X) excluding the target variable
X <- select(Ast_Subset, -c(Hazardous))
Y <- Ast_raw$Hazardous

# Fitting a Random Forest model to determine feature importance
set.seed(123)  # Setting a seed for reproducibility
rf_model <- randomForest(X, Y, ntree = 1000)

# Getting the feature importance
importance <- importance(rf_model)

# Printing importance
print(importance)


library(ggplot2)

# Get feature importance as a data frame
importance_df <- as.data.frame(importance(rf_model))

# Create a custom feature importance plot
ggplot(importance_df, aes(x = reorder(rownames(importance_df), -MeanDecreaseGini), y = MeanDecreaseGini)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(x = "Features", y = "Mean Decrease in Gini Index") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  ggtitle("Feature Importance in Asteroid Hazard Prediction")

```

\*\* From the above outputs we can infer the following:\*\*

Based on the feature importance values from the Random Forest model:

Influential Features:
The “Inclination” and “Perihelion.Distance” features have the highest feature importance scores, with values of 124.4 and 130.1, respectively. This suggests that these two features significantly impact the model’s ability to classify asteroids as hazardous or not.
Moderate Importance:
Features like “Absolute.Magnitude,” “Est.Dia.in.KM.min.,” “Est.Dia.in.KM.max.,” “Relative.Velocity.km.per.sec,” “Jupiter.Tisserand.Invariant,” “Eccentricity,” “Semi.Major.Axis,” and “Mean.Motion” also have importance scores above 50. These features contribute meaningfully to the model’s predictions.
Low Importance:
The features “Neo.Reference.ID,” “Name,” “Orbit.Uncertainty,” and “Aphelion.Dist” have relatively lower importance scores, all below 55. These features appear to have less influence on the model’s decision-making process.






